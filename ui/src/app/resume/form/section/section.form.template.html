<div class="flex flex-wrap justify-between items-center gap-2 mb-3">
  <mat-slide-toggle [checked]="showContent()" (change)="showContent.set($event.checked)"
    >Show content</mat-slide-toggle
  >
  <button matButton="tonal" (click)="addSectionItem()">
    <mat-icon>add</mat-icon> Add Section Item
  </button>
</div>

<form [hidden]="!showContent()" [formGroup]="form()">
  <field-form label="Content" [control]="$any(content)">
    <editor [control]="$any(content)" />
  </field-form>
</form>

<div
  cdkDropList
  [id]="`section-item-${idx()}`"
  class="section-items !min-h-12"
  [class.empty]="isSectionItemsEmpty()"
  [cdkDropListConnectedTo]="container_idx_list"
  [cdkDropListData]="section_items.controls"
  (cdkDropListDropped)="onDrop($event)"
>
  <mat-accordion>
    @for (sc of section_items.controls; track $index) {
    <mat-expansion-panel
      cdkDrag
      #sectionItems
      (cdkDragMoved)="dragMoveOutput.emit($event)"
      (cdkDragStarted)="dragStartOutput.emit($event)"
    >
      <mat-expansion-panel-header class="flex group">
        <drag-handle cdkDragHandle class="absolute inset-y-0 left-0 flex items-center px-1" />
        <mat-panel-title class="flex-1">
          <title-input-form
            [control]="$any(sc.get('title'))"
            placeholder="Enter Section Item Title..."
          />
        </mat-panel-title>
        <mat-panel-description class="!flex-none">
          <span [class.flex]="isTablet()" [class.hidden]="!isTablet()" class="group-hover:flex">
            <delete-button tooltip="Delete Section Item" (delete)="onDelete($event, $index)" />
          </span>
        </mat-panel-description>
      </mat-expansion-panel-header>
      <div *cdkDragPlaceholder class="h-12 w-full bg-surface-dimmer"></div>
      <section-item-form [form]="$any(sc)" />
    </mat-expansion-panel>
    }
  </mat-accordion>
</div>
